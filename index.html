<!DOCTYPE html>
<html lang="ms">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Isu Globalisasi Dalam Budaya</title>
<style>
  body { font-family:'Poppins',sans-serif; background:#efe8dd; color:#2f2b27; margin:0; padding:20px;}
  .container { max-width:900px; margin:auto; }
  .topic { background:#fffdf9; border-radius:10px; padding:18px; margin-bottom:20px; border:1px solid #dfd2bf; }
  h2 { color:#3f352d; margin-bottom:8px; }
  p { line-height:1.6; margin-bottom:12px; }
  .comments { background:#f7f3ee; border-radius:8px; padding:12px; min-height:60px; max-height:300px; overflow-y:auto; margin-bottom:12px;}
  .comment-box { background:#fdf8f2; border-radius:8px; padding:12px; display:flex; flex-direction:column; gap:8px; }
  input, textarea { padding:10px; border-radius:6px; border:1px solid #c8bdb1; background:#fffdfb; width:100%; }
  button { align-self:flex-end; background:linear-gradient(90deg,#FFD54F,#FFC107); border:none; color:#2f2f2f; padding:8px 16px; border-radius:6px; cursor:pointer; font-weight:600; box-shadow:0 4px 12px rgba(255,197,60,0.18);}
  .single-comment { background:#ffffff; border-left:4px solid #d6b984; border-radius:8px; padding:10px 12px; margin-bottom:10px; box-shadow:0 1px 3px rgba(0,0,0,0.04);}
  .comment-name { color:#3b3028; font-weight:600; margin-bottom:4px;}
  .comment-time { color:#7a6f63; font-size:12px;}
</style>
</head>
<body>
<div class="container">
  <h1 style="text-align:center;">ğŸ’¬ Isu Globalisasi Dalam Budaya</h1>
  <p style="text-align:center;">Baca perbincangan di bawah mengikut topik, kemudian tambah pendapat anda.</p>

  <div class="topic" id="topic1">
    <h2>ğŸ‘— Pakaian Moden: Fesyen Ke atau Dah Lupa Aurat?</h2>
    <p>Sekarang semua nak nampak bergaya â€” ikut tren, artis, dan influencer. Tapi dalam kejar fesyen moden, ramai dah lupa batas aurat dan kesopanan yang Islam ajar. Kita bangga ikut gaya Barat sebab nampak <i>â€œtrendyâ€</i> dan <i>â€œup to dateâ€</i>, tapi dalam masa sama maruah dan identiti Islam makin hilang.</p>
    <div id="comments-topic1" class="comments"></div>
    <div class="comment-box">
      <input id="name-topic1" placeholder="Nama (optional)">
      <textarea id="input-topic1" rows="3" placeholder="Tulis pendapat anda..."></textarea>
      <button onclick="postComment('topic1')">Hantar</button>
    </div>
  </div>

  <div class="topic" id="topic2">
    <h2>ğŸ’ Perkahwinan Bebas Anak: Kebebasan Atau Hilang Arah?</h2>
    <p>Semakin ramai pasangan pilih kahwin tanpa anak. Katanya nak fokus kerjaya, nak <i>â€œenjoy hidupâ€</i>, atau takut anak jadi beban. Pemikiran ni datang dari budaya Barat yang utamakan kebebasan diri. Tapi dalam Islam, anak itu rezeki dan amanah. Bila kita tolak zuriat, kita tolak tanggungjawab yang Allah beri.</p>
    <div id="comments-topic2" class="comments"></div>
    <div class="comment-box">
      <input id="name-topic2" placeholder="Nama (optional)">
      <textarea id="input-topic2" rows="3" placeholder="Tulis pendapat anda..."></textarea>
      <button onclick="postComment('topic2')">Hantar</button>
    </div>
  </div>

  <div class="topic" id="topic3">
    <h2>ğŸ‘« Pergaulan Bebas: Dah Biasa Sebab Dunia Dah Terbuka?</h2>
    <p><i>â€œKawan je pun.â€</i> â€” ayat paling biasa bila sebut pergaulan bebas. Tapi bila batas makin kabur, dosa jadi hal kecil. Budaya Barat buat semua tu nampak normal, padahal Islam dah tetapkan batas untuk jaga maruah. Dunia boleh terbuka, tapi jangan sampai prinsip Islam kita terbuka sama.</p>
    <div id="comments-topic3" class="comments"></div>
    <div class="comment-box">
      <input id="name-topic3" placeholder="Nama (optional)">
      <textarea id="input-topic3" rows="3" placeholder="Tulis pendapat anda..."></textarea>
      <button onclick="postComment('topic3')">Hantar</button>
    </div>
  </div>
</div>

<script src="https://www.gstatic.com/firebasejs/12.4.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/12.4.0/firebase-database-compat.js"></script>
<script>
// ***** GANTIKAN DENGAN FIREBASE CONFIG AWAK YANG SEBENAR *****
const firebaseConfig = {
  apiKey: "AIzaSyBqlGP3LrsHeS0MIJsw1b8zgYGV4KtS4R8",
  authDomain: "isu-globalisasi-budaya-comment.firebaseapp.com",
  databaseURL: "https://isu-globalisasi-budaya-comment-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "isu-globalisasi-budaya-comment",
  storageBucket: "isu-globalisasi-budaya-comment.appspot.com",
  messagingSenderId: "884609318165",
  appId: "1:884609318165:web:1740573c3ae6668208bd1c"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

function escapeHtml(unsafe){
  return unsafe.replace(/&/g,"&amp;").replace(/</g,"&lt;")
               .replace(/>/g,"&gt;").replace(/"/g,"&quot;")
               .replace(/'/g,"&#039;");
}

function makeCommentElement(data){
  const div = document.createElement('div');
  div.className = 'single-comment';
  const date = new Date(data.time);
  const timeStr = date.toLocaleString('ms-MY',{year:'numeric',month:'short',day:'numeric',hour:'numeric',minute:'2-digit'});
  div.innerHTML = `<div class="comment-name">${escapeHtml(data.name)}</div>
                   <div>${escapeHtml(data.text)}</div>
                   <div class="comment-time">${timeStr}</div>`;
  return div;
}

function postComment(topicId){
  // ===== INI BAHAGIAN YANG DIBETULKAN =====
  // Kita guna ` (backtick) untuk gabungkan string dan variable
  const nameInput = document.getElementById(`name-${topicId}`);
  const input = document.getElementById(`input-${topicId}`);
  // ==========================================

  const name = nameInput.value.trim() || 'Anonymous';
  const text = input.value.trim();
  if(!text){ alert('Sila tulis komen dahulu.'); return; }
  db.ref('comments/'+topicId).push({name,text,time:Date.now()});
  input.value=''; nameInput.value='';
}

function loadComments(topicId){
  const container = document.getElementById('comments-'+topicId);
  db.ref('comments/'+topicId).on('value', snapshot=>{
    container.innerHTML='';
    const data = snapshot.val();
    if(data){
      Object.values(data).sort((a,b)=>b.time-a.time).forEach(c=>{
        container.appendChild(makeCommentElement(c));
      });
    }
  });
}

['topic1','topic2','topic3'].forEach(loadComments);
</script>
</body>
</html>
 
